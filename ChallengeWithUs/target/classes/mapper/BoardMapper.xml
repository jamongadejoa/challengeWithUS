<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.smart.home.dao.BoardDAO">

	<insert id="boardWriteOk">
		insert into QABoard(qano, qatitle, qacontent, memberid, qahit, qadate)
		values(QABoard_QANO_SEQ.nextval, #{qatitle}, #{qacontent}, #{memberid}, 0, sysdate)
	</insert>

	<select id="boardList" resultType="com.smart.home.dto.BoardDTO">
		select * from (
			select * from (
				select qano, qatitle, memberid, qahit,
				to_char(qadate,'MM-DD HH:MI') qadate
				from QABoard
				<!-- 검색어가 있을 때 -->
				<if test="searchWord!=null">
					where ${searchKey} like '%${searchWord}%'
				</if>
				order by qano desc
			)
			where <![CDATA[rownum <= ${nowPage*onePageRecord}]]> order by qano asc
		)
		where <![CDATA[rownum <= ${lastPageRecord}]]> order by qano desc
	</select>

	<select id="totalRecord" resultType="int">
		select count(qano) cnt from QABoard
		<if test="searchWord != null">
			where ${searchKey} like '%${searchWord}%'
		</if>
	</select>

	<select id="getBoard" resultType="com.smart.home.dto.BoardDTO">
		select qano, qatitle, qacontent, qahit, qadate, memberid
		from QABoard
		where qano = #{param1}
	</select>

	<update id="hitCount">
		update QABoard set qahit = qahit + 1 where qano = #{param1}
	</update>

	<update id="boardEdit">
		update QABoard set qatitle = #{qatitle}, qacontent = #{qacontent}
		where qano = #{qano} and memberid = #{memberid}
		<!-- ''안붙으면 ${} -->
	</update>

	<delete id="boardDel">
		delete from QABoard where qano = #{param1} and memberid = #{param2}
	</delete>
</mapper>
